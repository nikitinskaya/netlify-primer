---
layout: page
---

# Делаем сайт на Jekyll и Netlify

---

## Собираем сайт на Джекиле

Сначала нужно установить Ruby, если нет, bundler, и гем Jekyll. [Инструкция](https://jekyllrb.com/docs/installation/)

Создаем проект:

```bash
~ mkdir netlify-primer
~ cd netlify-primer
netlify-primer jekyll new .
```

Запускаем проект локально: `jekyll serve`. Смотрим по адресу `http://localhost:4000`

Проверяем, что есть Gemfile, или создаем его: `bundle init`
В гемфайле, если есть строка `# gem "ruby"`, меняем ее на `gem jekyll`. Не забываем убрать хэштег, чтобы раскомментить строку.

Устанавливаем зависимости: `bundle install`

Открываем .gitignore и смотрим, чтобы там была строчка `_site`, чтобы не хранить сборку в гите.

## Размещаем на гитхабе
Это обязательное условие для работы нетлифай цмс.
Создаем новый репозиторий на гитхабе, инициализируем гит-репозиторий локально и пушим на гитхаб:

```
git init
git add .
git commit -m "Initial"
git remote add origin [your-repo-url.git]
git push origin master
```

## Правим сайт
По умолчанию, новый проект на Джекиле собирается с темой оформления "минима".
Дальнейшие варианты развития событий:
- оставить как есть и пользоваться
- подредактировать тему под свои нужды – [инструкция](https://jekyllrb.com/docs/themes/#overriding-theme-defaults)
- использовать другую джекил-тему
- не использовать тему и писать полностью свою структуру и стили

В этом проекте – второй вариант. Посмотреть, что изменилось, можно во втором и третьем коммитах проекта.

## Подключаем наш сайт к Нетлифаю
[Netlify](https://www.netlify.com) - это сервис, который предоставляет размещение на CDN (сети доставки контента), инструменты непрерывной интеграции (так, он будет пересобирать наш сайт по пушу в репозиторий), управление деплоями, некоторые бекенд-функции (например, обработку данных форм) и разные другие возможности.

Будем использовать его, т.к. он удобно настраивается для работы с Netlify CMS. Но вообще эта цмс не требует размещения именно там: можно хостить на Гитхаб Пейджес, своем сервере и где угодно еще.

Регистрируемся на [Netlify.com](https://www.netlify.com), заходим в [app.netlify.com](https://app.netlify.com).
Жмем Add new site, коннектим к провайдеру GitHub, авторизуем приложение.
Выбираем в списке своих репозиториев тот, в котором наш сайт.
Опции сборки можно оставить без изменений.
Сайт деплоится, можно посмотреть и насладиться результатом.

## Настраиваем Netlify Identity
Это сервис аутентификации, который предоставляет нам Нетлифай. Аутентификация понадобится, чтобы обеспечить доступ к гитхаб-репозиторию: ведь в процессе работы нетлифай цмс контент, добавленный пользователем, должен коммититься в проект.

Settings -> Identity -> Enable Identity Service
Settings -> Identity -> Services -> Enable git-gateway

В Settings -> Identity -> Registration можно указать свободную регистрацию (бесплатно до 1000 человек) или по инвайтам (бесплатно - 5).

Можно добавить регистрацию от других провайдеров, например, по аккаунту гитхаба:
Settings -> Identity -> Registration -> External providers
